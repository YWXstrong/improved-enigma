# 系统架构图

## 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                        用户浏览器                            │
│                    (User Browser)                          │
└───────────────────────┬─────────────────────────────────────┘
                        │
                        │ HTTP/HTTPS
                        │ JSON + Cookies (Session)
                        │
        ┌───────────────┴───────────────┐
        │                               │
        ▼                               ▼
┌───────────────┐              ┌───────────────┐
│  React 前端   │              │  Flask 后端    │
│  (Frontend)   │◄─────────────►│  (Backend)    │
│               │              │               │
│  - App.js     │              │  - app.py     │
│  - Auth.js    │              │  - Routes     │
│  - CSS        │              │  - Models     │
└───────────────┘              └───────┬───────┘
                                       │
                                       │ SQLAlchemy ORM
                                       │
                              ┌────────┴────────┐
                              │                │
                              ▼                ▼
                    ┌──────────────┐  ┌──────────────┐
                    │  SQLite     │  │  Session     │
                    │  Database   │  │  Storage     │
                    │             │  │              │
                    │  - users    │  │  - user_id   │
                    │    table    │  │  - user_name │
                    └─────────────┘  └──────────────┘
```

## 前端架构

```
┌─────────────────────────────────────┐
│          React 应用 (Frontend)       │
├─────────────────────────────────────┤
│                                     │
│  ┌──────────────┐  ┌──────────────┐ │
│  │   App.js     │  │   Auth.js    │ │
│  │              │  │              │ │
│  │ - 状态管理   │  │ - 登录表单   │ │
│  │ - 路由控制   │  │ - 注册表单   │ │
│  │ - 用户列表   │  │ - 表单验证   │ │
│  └──────┬───────┘  └──────┬───────┘ │
│         │                 │         │
│         └────────┬────────┘         │
│                  │                  │
│                  ▼                  │
│         ┌─────────────────┐        │
│         │   axios (HTTP)   │        │
│         │   - GET/POST     │        │
│         │   - withCredentials│     │
│         └─────────┬─────────┘       │
└───────────────────┼─────────────────┘
                    │
                    │ API 请求
                    ▼
```

## 后端架构

```
┌─────────────────────────────────────┐
│      Flask 后端 (Backend)            │
├─────────────────────────────────────┤
│                                     │
│  ┌──────────────────────────────┐  │
│  │      API 路由层               │  │
│  ├──────────────────────────────┤  │
│  │  GET  /                      │  │
│  │  GET  /api/users              │  │
│  │  POST /api/auth/register      │  │
│  │  POST /api/auth/login         │  │
│  │  POST /api/auth/logout        │  │
│  │  GET  /api/auth/me           │  │
│  │  GET  /api/health            │  │
│  └───────────┬──────────────────┘  │
│              │                      │
│  ┌───────────▼──────────────────┐  │
│  │      业务逻辑层                │  │
│  ├──────────────────────────────┤  │
│  │  - 密码加密 (PBKDF2)          │  │
│  │  - Session 管理               │  │
│  │  - 数据验证                   │  │
│  └───────────┬──────────────────┘  │
│              │                      │
│  ┌───────────▼──────────────────┐  │
│  │      数据访问层 (ORM)         │  │
│  ├──────────────────────────────┤  │
│  │  SQLAlchemy                  │  │
│  │  - User 模型                 │  │
│  │  - 数据库迁移                │  │
│  └───────────┬──────────────────┘  │
└─────────────┼──────────────────────┘
              │
              ▼
    ┌──────────────────┐
    │   SQLite 数据库   │
    ├──────────────────┤
    │  users 表         │
    │  - id            │
    │  - name          │
    │  - email         │
    │  - password_hash │
    │  - created_at   │
    │  - updated_at    │
    └──────────────────┘
```

## 数据流向

### 登录流程
```
用户输入
  ↓
Auth.js (前端)
  ↓ POST /api/auth/login
Flask 后端
  ↓ 验证密码 (check_password_hash)
SQLite 数据库
  ↓ 返回用户信息
Flask 后端
  ↓ 设置 Session
  ↓ 返回 JSON
Auth.js
  ↓ onLoginSuccess
App.js
  ↓ 更新状态
显示主界面
```

### 注册流程
```
用户输入
  ↓
Auth.js (前端)
  ↓ POST /api/auth/register
Flask 后端
  ↓ 加密密码 (generate_password_hash)
  ↓ 保存到数据库
SQLite 数据库
  ↓ 返回新用户
Flask 后端
  ↓ 设置 Session
  ↓ 返回 JSON
Auth.js
  ↓ onLoginSuccess
App.js
  ↓ 更新状态
显示主界面
```

## 技术栈

### 前端
- **React** - UI 框架
- **axios** - HTTP 客户端
- **CSS** - 样式

### 后端
- **Flask** - Web 框架
- **SQLAlchemy** - ORM
- **werkzeug** - 密码加密
- **Flask-CORS** - 跨域支持

### 数据库
- **SQLite** - 关系型数据库

## 端口配置

- **前端**: http://localhost:3000 (React 默认端口)
- **后端**: http://localhost:5000 (Flask 默认端口)


